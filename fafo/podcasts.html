<div class="container-fluid">
  <div class="row">
   <div class="col-12" >
     <div class="card">
       <div class="card-header">
                   <select id="selection" class="form-select form-select-lg mb-3" aria-label=".form-select-lg example">
         
         </select>
       </div>
       <div class="card-body">
       <img id="podcast-poster-img" class="img-fluid" src="./fafo/IMG_0749.jpeg"/>
       </div>
       <div class="card-footer">
        <p id="title"></p>
       </div>

     </div>
   
   </div> 
  </div> 
</div>

<script src="./fafo/howler.js"></script>

<script>
    $(function() {
       console.log("podcasts player JS looading ...");
                
    
      
       $.getJSON('./fafo/conf/podcasts.json', function(data) {         
       
         console.log(data);
       
       var myPlayList = data["podcasts"]
       
            for (var i = 0, len = myPlayList.length; i < len; i++) {
          let pod = myPlayList[i];
          let poster = pod['poster'];
          let title = pod['title'];

          
          $( "#selection" ).append(
            `<option value="${i}">${title}</button>`
          );
          
      }

      var podcast = null;
   
      $("select").on("change", function() {

       if (podcast != null) {
        podcast.stop();
        podcast.unload();
        podcast = null;
       }
     
       let trackIndex = this.value;
       let pod = myPlayList[parseInt(trackIndex)]
       let podTitle = pod["title"]
       let podSrc = pod["src"]
       let podPoster = pod["poster"]
       
       $("#title").text(podTitle);

       let podExt = podSrc.split('.').pop();
       console.log("podcast selected: "+podSrc);
       console.log("podcast source extension: "+podExt)
       console.log("podcast source support: " + Howler.codecs(podExt));
         
       podcast = new Howl({
          src: [podSrc],
          html5: true,
          volume: 0.9,
          onload: function() {
          	console.log("loading podcast ...");
          },
        
          onplay: function(id) {
          	console.log("playing podcast ...");
            $("#podcast-poster-img" ).attr("src","./fafo/sound.gif");
          },
        
          onstop: function(id) {
          	console.log("stopping podcast ...");
           $("#podcast-poster-img" ).attr("src","./fafo/IMG_0749.jpeg");
            
          },
          onend: function() {
          	console.log("podcast ended");
          	           $("#podcast-poster-img" ).attr("src","./fafo/IMG_0749.jpeg");
          	
            Howler.unload();
          },
          onplayerror: function() {
          	console.log("error playing podcast");
            Howler.unload();
          },
          onloaderror: function() {
          	console.log("error loading podcast");
            Howler.unload();
          }
          
      });
       
      podcast.play();
      
      });
      
      

     }).fail(function(){
          console.log("Error occured when trying to load data sources page.");
     });

     

 });
</script>

  
