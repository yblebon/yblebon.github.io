<div id="podcast" class="container">
  <div class="row">
   
   <div class="col-8">
     <div id="podcast-poster" > 
       <img id="podcast-img" src="IMG_0749.jpeg"/>
     </div>
   </div>
   
   <div class="col-4">
     <div id="podcast-player-playlist">
       <h4> Podcasts Playlist </h4>
     </div>
   </div>
   
  </div> 
</div>

<script src="./howler.js"></script>

<script>
    $(function() {
       console.log("podcasts player JS looading ...");
      
       $.getJSON('./conf/podcasts.json', function(data) {         
       
         console.log(data);
       
       var myPlayList = data["podcasts"]
       
            for (var i = 0, len = myPlayList.length; i < len; i++) {
          let pod = myPlayList[i];
          let poster = pod['poster'];
          let title = pod['title'];
          $( "#podcast-player-playlist" ).append( '<p track-index="'+i+'" >'+title+'</p>' );
      }

      var podcast = null;
   
      $("#podcast-player-playlist p").on("click", function() {

       if (podcast != null) {
        podcast.stop();
        podcast.unload();
        podcast = null;
       }

       
       let trackIndex = $(this).attr("track-index");
       let pod = myPlayList[parseInt(trackIndex)]
       let podTitle = pod["title"]
       let podSrc = pod["src"]
       let podPoster = pod["poster"]

       let podExt = podSrc.split('.').pop();
       console.log("podcast selected: "+podSrc);
       console.log("podcast source extension: "+podExt)
       console.log("podcast source support: " + Howler.codecs(podExt));
         
       podcast = new Howl({
          src: [podSrc],
          html5: true,
          volume: 0.9,
          onload: function() {
          	console.log("loading podcast ...");
          },
        
          onplay: function(id) {
          	console.log("playing podcast ...");
           $( "#podcast-img" ).attr("src","sound.gif");
          },
        
          onstop: function(id) {
          	console.log("stopping podcast ...");
           $( "#podcast-img" ).attr("src","IMG_0749.jpeg");
            
          },
          onend: function() {
          	console.log("podcast ended");
            Howler.unload();
          },
          onplayerror: function() {
          	console.log("error playing podcast");
            Howler.unload();
          },
          onloaderror: function() {
          	console.log("error loading podcast");
            Howler.unload();
          }
          
      });
       
      podcast.play();
      
      });
      
      

     }).fail(function(){
          console.log("Error occured when trying to load data sources page.");
     });

     

 });
</script>

  
